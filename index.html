<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shroom Uploads</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="shroom-styles.css">
    
    <!-- Supabase SDK -->
    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'
        
        // Initialize Supabase
        const supabaseUrl = 'https://nxvamweowhoepvgygttj.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im54dmFtd2Vvd2hvZXB2Z3lndHRqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYyNjM0MTYsImV4cCI6MjA3MTgzOTQxNn0.DrN6DMomcXrj3Zwx3guzMpxE5_PCaA1M7xbVihuvunI'
        
        // Create Supabase client
        window.supabase = createClient(supabaseUrl, supabaseKey)
        
        console.log('Supabase initialized:', window.supabase)
    </script>
</head>
<body>
    <!-- Background Animation -->
    <div class="background-animation">
        <div class="spore spore-1"></div>
        <div class="spore spore-2"></div>
        <div class="spore spore-3"></div>
        <div class="spore spore-4"></div>
    </div>

    <!-- Header -->
    <header>
        <div class="logo">
            <div class="logo-icon">
                <img src="https://cdn.discordapp.com/attachments/1265508598008512545/1410120008238895154/shroom.png?ex=68b327d8&is=68b1d658&hm=eb5e2db6ba4bcbf068dcf46e9d9d6cdf35161b437ff3a7323e2ccb6c0d9649d3&" alt="Shroom Uploads Logo" class="logo-image">
            </div>
            <span class="logo-text">Shroom Uploads</span>
        </div>
        <nav>
            <button class="nav-btn active" onclick="switchSection('upload')">Upload</button>
            <button class="nav-btn" onclick="switchSection('files')">My Files</button>
            <button class="nav-btn" onclick="switchSection('stats')">Statistics</button>
            <button class="nav-btn" onclick="switchSection('account')">Account</button>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Upload Section -->
        <section id="uploadSection" class="section active">
            <div class="upload-container">
                <h2 class="section-title">Upload Files</h2>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3 class="upload-title">Drag & Drop Files Here</h3>
                        <p class="upload-subtitle">Drop your files anywhere in this area, or click to browse</p>
                        <div class="upload-hint">
                            <i class="fas fa-mouse-pointer"></i>
                            <span>Click anywhere to browse files</span>
                        </div>
                    </div>
                    <input type="file" id="fileInput" multiple accept="*/*" style="display: none;">
                </div>
            </div>

            <div class="upload-progress" id="uploadProgress" style="display: none;">
                <div class="progress-header">
                    <h4>Uploading Files</h4>
                    <span class="progress-text" id="progressText">0%</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                        <div class="progress-shimmer"></div>
                    </div>
                    <div class="progress-stats">
                        <div class="progress-stat">
                            <i class="fas fa-file"></i>
                            <span id="uploadFileName">filename.ext</span>
                        </div>
                        <div class="progress-stat">
                            <i class="fas fa-hdd"></i>
                            <span id="uploadFileSize">0 KB</span>
                        </div>
                        <div class="progress-stat">
                            <i class="fas fa-clock"></i>
                            <span id="uploadSpeed">0 KB/s</span>
                        </div>
                    </div>
                </div>
                <div class="upload-actions">
                    <button class="action-btn danger" id="cancelUpload" onclick="cancelUpload()">
                        <i class="fas fa-times"></i>
                        Cancel Upload
                    </button>
                </div>
            </div>
        </section>

        <!-- Files Section -->
        <section id="filesSection" class="section">
            <div class="section-header">
                <h2>My Files</h2>
                <div class="files-controls">
                    <div class="search-container">
                        <input type="text" id="fileSearch" placeholder="Search files..." class="search-input">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <div class="sort-container">
                        <select id="sortSelect" class="sort-select">
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="name-asc">Name A-Z</option>
                            <option value="name-desc">Name Z-A</option>
                            <option value="size-desc">Largest First</option>
                            <option value="size-asc">Smallest First</option>
                        </select>
                    </div>
                    <button class="action-btn secondary" onclick="toggleBulkSelect()" id="bulkSelectBtn">
                        <i class="fas fa-check-square"></i>
                        Select Multiple
                    </button>
                    <button class="action-btn secondary" onclick="manualLoadFiles()" title="Refresh Files">
                        <i class="fas fa-sync-alt"></i>
                        Refresh
                    </button>
                    <button class="action-btn danger" onclick="showClearAllConfirmation()" title="Clear All Files">
                        <i class="fas fa-trash"></i>
                        Clear All
                    </button>
                </div>
            </div>

            <div class="storage-info">
                <div class="storage-bar">
                    <div class="storage-fill" id="storageFill"></div>
                </div>
                <div class="storage-text">
                    <span id="storageUsed">0 KB</span> of <span id="storageTotal">100 MB</span> used
                </div>
            </div>

            <div class="bulk-actions" id="bulkActions" style="display: none;">
                <div class="bulk-info">
                    <span id="selectedCount">0</span> files selected
                </div>
                <div class="bulk-buttons">
                    <button class="action-btn secondary" onclick="selectAllFiles()">
                        <i class="fas fa-check-double"></i>
                        Select All
                    </button>
                    <button class="action-btn secondary" onclick="deselectAllFiles()">
                        <i class="fas fa-times"></i>
                        Deselect All
                    </button>
                    <button class="action-btn danger" onclick="deleteSelectedFiles()">
                        <i class="fas fa-trash"></i>
                        Delete Selected
                    </button>
                </div>
            </div>

            <div class="files-container" id="filesContainer">
                <!-- Files will be loaded here -->
            </div>
        </section>

        <!-- Statistics Section -->
        <section id="statsSection" class="section">
            <div class="section-header">
                <h2>Upload Statistics</h2>
                <p>Track your file upload activity and storage usage</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-file"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalFiles">0</h3>
                        <p>Total Files</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-hdd"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalStorage">0 KB</h3>
                        <p>Storage Used</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-download"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalDownloads">0</h3>
                        <p>Total Downloads</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-share"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalShares">0</h3>
                        <p>Shared Files</p>
                    </div>
                </div>
            </div>

            <div class="recent-files">
                <h3>Recent Files</h3>
                <div class="recent-files-list" id="recentFilesList">
                    <!-- Recent files will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Account Section -->
        <section id="accountSection" class="section">
            <div class="account-container">
                <div class="account-header">
                    <h2 class="account-title">Account</h2>
                    <p class="account-subtitle">Manage your account and preferences</p>
                </div>
                
                <div class="auth-container">
                    <!-- Login Form -->
                    <div class="auth-card" id="loginForm">
                        <h3>Sign In</h3>
                        <form id="loginFormElement">
                            <div class="form-group">
                                <label for="loginEmail">Email</label>
                                <input type="email" id="loginEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="loginPassword">Password</label>
                                <div class="password-input-container">
                                    <input type="password" id="loginPassword" required>
                                    <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="submit" class="auth-btn primary">
                                <i class="fas fa-arrow-right"></i>
                                Sign In
                            </button>
                        </form>
                        
                        <div class="auth-divider">
                            <span>or</span>
                        </div>
                        
                        <button class="auth-btn google" onclick="signInWithGoogle()">
                            <i class="fab fa-google"></i>
                            Sign in with Google
                        </button>
                        
                        <div class="auth-switch">
                            Don't have an account? <a href="#" onclick="showSignupForm()">Sign up</a>
                        </div>
                    </div>

                    <!-- Signup Form -->
                    <div class="auth-card" id="signupForm" style="display: none;">
                        <h3>Create Account</h3>
                        <form id="signupFormElement">
                            <div class="form-group">
                                <label for="signupName">Full Name</label>
                                <input type="text" id="signupName" required>
                            </div>
                            <div class="form-group">
                                <label for="signupEmail">Email</label>
                                <input type="email" id="signupEmail" required>
                            </div>
                            <div class="form-group">
                                <label for="signupPassword">Password</label>
                                <div class="password-input-container">
                                    <input type="password" id="signupPassword" required>
                                    <button type="button" class="password-toggle" onclick="togglePassword('signupPassword')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="signupConfirmPassword">Confirm Password</label>
                                <div class="password-input-container">
                                    <input type="password" id="signupConfirmPassword" required>
                                    <button type="button" class="password-toggle" onclick="togglePassword('signupConfirmPassword')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="submit" class="auth-btn primary">
                                <i class="fas fa-user-plus"></i>
                                Create Account
                            </button>
                        </form>
                        
                        <div class="auth-divider">
                            <span>or</span>
                        </div>
                        
                        <button class="auth-btn google" onclick="signUpWithGoogle()">
                            <i class="fab fa-google"></i>
                            Sign up with Google
                        </button>
                        
                        <div class="auth-switch">
                            Already have an account? <a href="#" onclick="showLoginForm()">Sign in</a>
                        </div>
                    </div>

                    <!-- User Profile -->
                    <div class="auth-card" id="userProfile" style="display: none;">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <img id="userAvatar" src="https://via.placeholder.com/64" alt="User Avatar">
                            </div>
                            <div class="profile-info">
                                <h3 id="userName">User Name</h3>
                                <p id="userEmail">user@example.com</p>
                            </div>
                        </div>
                        
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <span class="stat-number" id="totalFiles">0</span>
                                <span class="stat-label">Files</span>
                            </div>
                            <div class="profile-stat">
                                <span class="stat-number" id="totalStorage">0 MB</span>
                                <span class="stat-label">Storage</span>
                            </div>
                        </div>
                        
                        <div class="profile-actions">
                            <button class="action-btn primary" onclick="editProfile()">
                                <i class="fas fa-edit"></i>
                                Edit Profile
                            </button>
                            <button class="action-btn secondary" onclick="signOut()">
                                <i class="fas fa-sign-out-alt"></i>
                                Sign Out
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- File Modal -->
    <div id="fileModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>File Details</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="file-info">
                    <h4 id="modalFileName">filename.ext</h4>
                    <p id="modalFileSize">0 KB</p>
                    <p id="modalFileType">application/octet-stream</p>
                </div>
                <div class="modal-actions">
                    <button class="action-btn" onclick="downloadCurrentFile()">
                        <i class="fas fa-download"></i>
                        Download
                    </button>
                    <button class="action-btn danger" onclick="deleteCurrentFile()">
                        <i class="fas fa-trash"></i>
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteConfirmationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete "<span id="deleteFileName"></span>"?</p>
                <p>This action cannot be undone.</p>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="cancelDelete()">Cancel</button>
                    <button class="action-btn danger" onclick="confirmDelete()">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Clear All Confirmation Modal -->
    <div id="clearAllConfirmationModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Clear All Files</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="clear-all-warning">
                    <i class="fas fa-exclamation-triangle warning-icon"></i>
                    <p>Are you sure you want to delete all <strong><span id="clearAllFileCount">0</span> files</strong>?</p>
                    <p>This action cannot be undone and will permanently remove all your uploaded files.</p>
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="cancelClearAll()">Cancel</button>
                    <button class="action-btn danger" onclick="confirmClearAll()">
                        <i class="fas fa-trash"></i>
                        Clear All Files
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Archive Contents Modal -->
    <div id="archiveContentsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Archive Contents</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="archive-header">
                    <h4 id="archiveFileName">archive.rar</h4>
                    <p class="archive-file-size">Archive size: <span id="archiveFileSize">0 KB</span></p>
                    <p class="archive-subtitle">Browse the contents of this archive file</p>
                </div>
                <div class="archive-contents" id="archiveContentsList">
                    <!-- Archive contents will be loaded here -->
                </div>
                <div class="modal-actions">
                    <button class="action-btn secondary" onclick="document.getElementById('archiveContentsModal').style.display='none'">
                        <i class="fas fa-times"></i>
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Shared File Modal -->
    <div id="sharedFileModal" class="modal" style="display: none;">
        <div class="modal-content shared-file-modal">
            <div class="modal-header">
                <div class="header-content">
                    <div class="header-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <h3>Shared File</h3>
                </div>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="shared-file-preview">
                    <div class="file-icon-large">
                        <i id="sharedFileIcon" class="fas fa-file"></i>
                    </div>
                    <div class="shared-file-details">
                        <h4 id="sharedFileName">filename.ext</h4>
                        <div class="file-meta">
                            <div class="meta-item">
                                <i class="fas fa-hdd"></i>
                                <span id="sharedFileSize">0 KB</span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-tag"></i>
                                <span id="sharedFileType">application/octet-stream</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button class="action-btn primary" onclick="downloadSharedFileFromModal()">
                        <i class="fas fa-download"></i>
                        Download File
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="shroom-script.js"></script>
</body>
</html>